var BOARD_DATA_URL = 'OVERRIDE THIS IN VIEW';
var GAME_ID = 'OVERRIDE THIS IN VIEW';
var CAMPAIGN_ID = 'OVERRIDE THIS IN VIEW';

var PIXEL_RATIO = (function () {
  var ctx = document.createElement("canvas").getContext("2d"),
    dpr = window.devicePixelRatio || 1,
    bsr = ctx.webkitBackingStorePixelRatio ||
      ctx.mozBackingStorePixelRatio ||
      ctx.msBackingStorePixelRatio ||
      ctx.oBackingStorePixelRatio ||
      ctx.backingStorePixelRatio || 1;

  return dpr / bsr;
})();

var game_board = null;
var game_data = null;

function startGameBoard() {
  document.addEventListener('DOMContentLoaded', function() {
    //var camera = InitializeCameraApi();



    game_board = new Board(document.getElementById("game_board"), null);

    window.addEventListener('resize', function(e) {
      if (e.target == window) {
        setCanvasSize();
      }
    });

    setCanvasSize();
    refreshBoard();
  });
}

window.requestAnimFrame = (function () {
  return window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || window.oRequestAnimationFrame || window.msRequestAnimationFrame ||
          function (callback) {
            window.setTimeout(callback, 1000 / 60);
          };
})();

function setCanvasSize() {
  // Set game board size
  //var b = document.getElementById("game_board_container");
  var width = Math.floor(window.innerWidth);
  var height = Math.floor(window.innerHeight);
  game_board.setCanvasSize(width, height, PIXEL_RATIO);
}

function draw_game() {
  game_board.update();

  window.requestAnimFrame(draw_game);
}

function setSize(zoom) {
  game_board.setZoom(parseFloat(zoom));
}

function refreshBoard() {
  Api.getJson(BOARD_DATA_URL).then(function(data) {
    game_data = data;
    setSize(1.0);
    game_board.refresh(data);
    draw_game();
  });
}